///////////////////////// TRIGGER /////////////////////////


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
TRIGGER PARA ATUALIZAR A DATA DE SAÍDA

DELIMITER //
CREATE TRIGGER atualiza_dtsaida
AFTER INSERT ON transferencia
FOR EACH ROW
BEGIN
    IF NEW.transf_data IS NOT NULL THEN
        UPDATE internacao
        SET intern_dtsaida = NEW.transf_data
        WHERE intern_id = NEW.intern_id_transf AND intern_dtsaida IS NULL;
    END IF;
END;
//
DELIMITER ;
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
TRIGGER PARA ATUALIZAR O TIPO DE SAÍDA

DELIMITER //
CREATE TRIGGER atualiza_tpsaida
AFTER INSERT ON transferencia
FOR EACH ROW
BEGIN
    IF NEW.transf_data IS NOT NULL THEN
        UPDATE internacao
        SET intern_tpsaida = 'Transferência'
        WHERE intern_id = NEW.intern_id_transf AND intern_tpsaida IS NULL;
    END IF;
END;
//
DELIMITER ;
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////